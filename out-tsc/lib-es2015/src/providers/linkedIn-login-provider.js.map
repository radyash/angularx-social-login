{"version":3,"file":"linkedIn-login-provider.js","sourceRoot":"","sources":["../../../lib/src/providers/linkedIn-login-provider.ts"],"names":[],"mappings":"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","sourcesContent":["import { BaseLoginProvider } from '../entities/base-login-provider';\nimport { SocialUser } from '../entities/user';\nimport { LoginOpt } from '../auth.service';\n\ndeclare let IN: any;\n\nexport class LinkedInLoginProvider extends BaseLoginProvider {\n\n    public static readonly PROVIDER_ID: string = 'LINKEDIN';\n\n    constructor(\n        private clientId: string,\n        private authorize?: boolean,\n        private lang?: string,\n        private fields: string = 'id,first-name,last-name,email-address,picture-url'\n    ) {\n        super();\n    }\n\n    initialize(): Promise<void> {\n        let inner_text = '';\n\n        inner_text += 'api_key: ' + this.clientId + '\\r\\n';\n        inner_text += 'authorize:' + (this.authorize ? 'true' : 'false') + '\\r\\n';\n        inner_text += 'lang: ' + (this.lang ? this.lang : 'fr_FR') + '\\r\\n';\n\n        return new Promise((resolve, reject) => {\n            this.loadScript(LinkedInLoginProvider.PROVIDER_ID,\n                '//platform.linkedin.com/in.js',\n                () => {\n                    let that = this;\n                    setTimeout(() => {\n                        this._readyState.next(true);\n                        resolve();\n                    }, 800);\n                }, false, inner_text);\n        });\n    }\n\n    getLoginStatus(): Promise<SocialUser> {\n        return new Promise((resolve, reject) => {\n            this.onReady().then(() => {\n                if (IN.User.isAuthorized()) {\n                    IN.API.Raw(`/people/~:(${this.fields})`).result((res: any) => {\n                        let user: SocialUser = new SocialUser();\n                        user.id = res.id;\n                        user.name = res.firstName + ' ' + res.lastName;\n                        user.email = res.emailAddress;\n                        user.photoUrl = res.pictureUrl;\n                        user.firstName = res.firstName;\n                        user.lastName = res.lastName;\n                        user.authToken = IN.ENV.auth.oauth_token;\n                        user.linkedIn = res;\n\n                        resolve(user);\n                    });\n                } else {\n                    reject('No user is currently logged in.');\n                }\n            });\n        });\n    }\n\n    signIn(): Promise<SocialUser> {\n        return new Promise((resolve, reject) => {\n            this.onReady().then(() => {\n                IN.User.authorize(() => {\n                    IN.API.Raw(`/people/~:(${this.fields})`).result((res: any) => {\n                        let user: SocialUser = new SocialUser();\n                        user.id = res.id;\n                        user.name = res.firstName + ' ' + res.lastName;\n                        user.email = res.emailAddress;\n                        user.photoUrl = res.pictureUrl;\n                        user.firstName = res.firstName;\n                        user.lastName = res.lastName;\n                        user.authToken = IN.ENV.auth.oauth_token;\n\n                        user.linkedIn = res;\n\n                        resolve(user);\n                    });\n                });\n            });\n        });\n    }\n\n    signOut(): Promise<any> {\n        return new Promise((resolve, reject) => {\n            this.onReady().then(() => {\n                IN.User.logout(() => {\n                    resolve();\n                }, {});\n            });\n        });\n    }\n}\n"]}